window.__require=function t(e,o,n){function r(i,l){if(!o[i]){if(!e[i]){var s=i.split("/");if(s=s[s.length-1],!e[s]){var a="function"==typeof __require&&__require;if(!l&&a)return a(s,!0);if(c)return c(s,!0);throw new Error("Cannot find module '"+i+"'")}i=s}var u=o[i]={exports:{}};e[i][0].call(u.exports,function(t){return r(e[i][1][t]||t)},u,u.exports,t,e,o,n)}return o[i].exports}for(var c="function"==typeof __require&&__require,i=0;i<n.length;i++)r(n[i]);return r}({AbilityIcon:[function(t,e,o){"use strict";cc._RF.push(e,"b6141PdawBC5roIE+2gnzWg","AbilityIcon");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=i.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconParentNode=null,e.textNode=null,e.sprite=null,e.label=null,e.spriteNode=null,e}return r(e,t),e.prototype.onLoad=function(){this.spriteNode&&(this.sprite=this.spriteNode.getComponent(cc.Sprite)),this.textNode&&(this.label=this.textNode.getComponent(cc.RichText))},e.prototype.setIcon=function(t){this.spriteNode=t,this.spriteNode.setParent(this.iconParentNode),this.spriteNode.position=cc.Vec3.ZERO},e.prototype.setPicked=function(t){this.sprite&&(this.sprite.node.color=t?cc.Color.GREEN:cc.Color.WHITE)},e.prototype.setText=function(t){this.label&&(this.label.string=t)},c([s(cc.Node)],e.prototype,"iconParentNode",void 0),c([s(cc.Node)],e.prototype,"textNode",void 0),c([l],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],AbilityManager:[function(t,e,o){"use strict";cc._RF.push(e,"b4fd3ik41BJHKo5m1W74yVd","AbilityManager");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./AbilityIcon"),l=t("./Boosters/Ability"),s=cc._decorator,a=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.abilities=[],e.abilityIconPrefab=null,e.abilityIcons=[],e}return r(e,t),e.prototype.start=function(){var t=this;this.abilities.forEach(function(e){var o=cc.instantiate(t.abilityIconPrefab);o.parent=t.node;var n=o.getComponent(i.default);if(n){n.setIcon(e);var r=e.getComponent(l.default);n.setText(r.getNumberOfUses().toString()),e.on("OnAbilityUsed",function(t){n.setText(t.toString())},t),t.abilityIcons.push(n)}})},c([u([cc.Node])],e.prototype,"abilities",void 0),c([u(cc.Prefab)],e.prototype,"abilityIconPrefab",void 0),c([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./AbilityIcon":"AbilityIcon","./Boosters/Ability":"Ability"}],Ability:[function(t,e,o){"use strict";cc._RF.push(e,"ba660NKtRxCZZ5g6dz1U3Aa","Ability");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=i.property,a=t("../Grid"),u=t("../BlocksManager"),p=t("../BlockMovementController"),f=t("../TurnsController"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numberOfUses=3,e.grid=null,e.blockManager=null,e.turnsController=null,e.blockMovementController=null,e.iconNode=null,e.boosterEnabled=!1,e.gridStable=!1,e}return r(e,t),e.prototype.getNumberOfUses=function(){return this.numberOfUses},e.prototype.onLoad=function(){this.iconNode&&(this.iconNode.on(cc.Node.EventType.MOUSE_DOWN,this.onIconClick,this),this.iconNode.on(cc.Node.EventType.TOUCH_CANCEL,this.onIconClick,this)),this.blockMovementController&&this.blockMovementController.node.on("OnGridStabilityChange",this.onGridStabilityChange,this)},e.prototype.onUsed=function(){this.numberOfUses--,this.node.emit("OnAbilityUsed",this.numberOfUses),this.turnsController.Increment()},e.prototype.updateLock=function(t){this.blockManager.lockGrid(t?1:-1)},e.prototype.onGridStabilityChange=function(t){this.gridStable=t},c([s],e.prototype,"numberOfUses",void 0),c([s(a.default)],e.prototype,"grid",void 0),c([s(u.default)],e.prototype,"blockManager",void 0),c([s(f.default)],e.prototype,"turnsController",void 0),c([s(p.default)],e.prototype,"blockMovementController",void 0),c([s(cc.Node)],e.prototype,"iconNode",void 0),c([l],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../BlockMovementController":"BlockMovementController","../BlocksManager":"BlocksManager","../Grid":"Grid","../TurnsController":"TurnsController"}],BlockFactory:[function(t,e,o){"use strict";cc._RF.push(e,"daa35YLCrtBjrZGed5j8dv2","BlockFactory");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=i.property,a=t("./Block"),u=t("./PairStructs"),p=t("./ObjectPool"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blockPrefab=null,e.blockPairs=[],e.boosters=[],e}return r(e,t),e.prototype.createRandom=function(t){var e=Math.floor(Math.random()*this.getRegularBlockTypesCount());return this.createBlockOfType(e,t)},e.prototype.createBlockOfType=function(t,e){var o=this.blockPairs[t],n=this.getBoosterOfType(t);n||(n=this.blockPrefab);var r=p.default.Instance.getObject(n,!0);r.setParent(e);var c=r.getComponent(a.default);return c.init(o.blockType,o.sprite),c},e.prototype.isRegular=function(t){return null==this.getBoosterOfType(t)},e.prototype.getRegularBlockTypesCount=function(){return this.blockPairs.length-this.boosters.length},e.prototype.getBoosterOfType=function(t){for(var e=0;e<this.boosters.length;e++)if(this.boosters[e].blockType===t)return this.boosters[e].prefab;return null},c([s(cc.Prefab)],e.prototype,"blockPrefab",void 0),c([s([u.BlockSpritePair])],e.prototype,"blockPairs",void 0),c([s([u.BlockPrefabPair])],e.prototype,"boosters",void 0),c([l],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./Block":"Block","./ObjectPool":"ObjectPool","./PairStructs":"PairStructs"}],BlockMovementController:[function(t,e,o){"use strict";cc._RF.push(e,"7993710dNpA6qdDc+ukX7Z9","BlockMovementController");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=i.property,a=t("./Grid"),u=t("./BlockFactory"),p=t("./BlocksManager"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blockManager=null,e.grid=null,e.blockFactory=null,e.fallSpeed=500,e.spawnHeightOffset=300,e.fallingBlocks=[],e}return r(e,t),e.prototype.onLoad=function(){this.grid&&this.grid.node.on("OnGridCreate",this.refillGrid,this),this.blockManager&&this.blockManager.node.on("OnBlocksDestroy",this.refillGrid,this)},e.prototype.refillGrid=function(){if(this.grid&&this.blockFactory){var t=this.grid.getGridParameters().x,e=this.grid.getGridParameters().y;this.spawnNewBlocks(t,e),this.moveExistingBlocksDown(t,e),this.adjustFallingBlocks(t,e)}},e.prototype.removeFallingBlock=function(t){this.fallingBlocks=this.fallingBlocks.filter(function(e){return e.block!==t}),t.activeTween.stop()},e.prototype.getFallingBlocksInColumn=function(t){return this.fallingBlocks.filter(function(e){return e.col===t}).map(function(t){return t.block})},e.prototype.getNumberOfBlocksInGridPerColumn=function(){if(!this.grid)return[];for(var t=this.grid.getGridParameters().x,e=this.grid.getGridParameters().y,o=Array(t).fill(0),n=0;n<t;n++)for(var r=0;r<e;r++)this.grid.getCellAt(r,n).isOccupied()&&o[n]++;return o},e.prototype.spawnNewBlocks=function(t,e){for(var o=this.getNumberOfBlocksInGridPerColumn(),n=function(t){for(var n=e-o[t]-r.fallingBlocks.filter(function(e){return e.col===t}).length,c=0;c<n;c++){var i=c,l=r.blockFactory.createRandom(r.grid.getParent()),s=r.grid.getCellPosition(i,t),a=s.y+r.spawnHeightOffset;l.node.position=cc.v3(s.x,a,0),r.fallingBlocks.push({block:l,col:t})}},r=this,c=0;c<t;c++)n(c)},e.prototype.moveExistingBlocksDown=function(t,e){for(var o=Array(t).fill(e-1),n=Array(t).fill(Number.POSITIVE_INFINITY),r=0;r<t;r++)for(var c=e-1;c>=0;c--){var i=this.grid.getCellAt(c,r),l=i.getBlock();l?o[r]!==c?(i.setBlock(null),this.fallingBlocks.push({block:l,col:r}),o[r]--):o[r]--:n[r]==Number.POSITIVE_INFINITY&&(n[r]=c)}return n},e.prototype.adjustFallingBlocks=function(t,e){if(this.grid){var o=Array(t).fill(0).map(function(){return[]});this.fallingBlocks.forEach(function(t){o[t.col].push(t)}),this.fallingBlocks=[];for(var n=this.moveExistingBlocksDown(t,e),r=0;r<t;r++){var c=0,i=o[r];if(i.sort(function(t,e){return t.block.node.position.y-e.block.node.position.y}),n[r]!=Number.POSITIVE_INFINITY)for(var l=n[r];l>=0;l--)this.animateBlockToCell(i[c].block,l,r),c++}this.fallingBlocks.length>0&&this.node.emit("OnGridStabilityChange",!1)}},e.prototype.animateBlockToCell=function(t,e,o){var n=this,r=this.grid.getCellPosition(e,o),c=t.node.position.sub(r).mag()/this.fallSpeed;t.activeTween&&t.activeTween.stop(),t.activeTween=cc.tween(t.node).to(c,{position:r},{easing:"linear"}).call(function(){n.grid.getCellAt(e,o).setBlock(t);var r=n.fallingBlocks.findIndex(function(e){return e.block===t&&e.col===o});r>=0&&n.fallingBlocks.splice(r,1),t.playLandingAnimation(),0==n.fallingBlocks.length&&n.node.emit("OnGridStabilityChange",!0)}).start(),t.targetCell=this.grid.getCellAt(e,o),this.fallingBlocks.push({block:t,col:o})},c([s(p.default)],e.prototype,"blockManager",void 0),c([s(a.default)],e.prototype,"grid",void 0),c([s(u.default)],e.prototype,"blockFactory",void 0),c([s],e.prototype,"fallSpeed",void 0),c([s],e.prototype,"spawnHeightOffset",void 0),c([l],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./BlockFactory":"BlockFactory","./BlocksManager":"BlocksManager","./Grid":"Grid"}],BlocksManager:[function(t,e,o){"use strict";cc._RF.push(e,"8894foBoQREYYLYf5zBpbxt","BlocksManager");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=i.property,a=t("./Grid"),u=t("./Block"),p=t("./BlockFactory"),f=t("./PairStructs"),h=t("./TurnsController"),d=t("./PointsController"),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.grid=null,e.blockFactory=null,e.turnsController=null,e.pointsController=null,e.minCellCountToDestroy=3,e.minCellCountsToSpawnBooster=[],e.inputLock=0,e}return r(e,t),e.prototype.onLoad=function(){var t=cc.find("Canvas");t.on(cc.Node.EventType.MOUSE_DOWN,this.onMouseDown,this),t.on(cc.Node.EventType.TOUCH_START,this.onMouseDown,this),this.minCellCountToSpawnBooster=this.minCellCountsToSpawnBooster.length>0?Math.min.apply(Math,this.minCellCountsToSpawnBooster.map(function(t){return t.number})):Number.MAX_SAFE_INTEGER},e.prototype.getGridLock=function(){return this.inputLock},e.prototype.getMinCellCountToDestroy=function(){return this.minCellCountToDestroy},e.prototype.lockGrid=function(t){this.inputLock+=t,0==this.inputLock&&this.node.emit("OnBlocksDestroy",this)},e.prototype.getMinimumCellCountToSpawnBooster=function(t){for(var e=0;e<this.minCellCountsToSpawnBooster.length;e++){var o=this.minCellCountsToSpawnBooster[e];if(o.blockType===t)return o.number}return Number.MAX_SAFE_INTEGER},e.prototype.onMouseDown=function(t){if(this.grid&&!(this.inputLock>0)){var e=this.grid.getCellAtMousePosition(t);this.checkIfCellHasBooster(e)||this.tryDestroyZoneAndSpawnBooster(t)}},e.prototype.tryDestroyZoneAndSpawnBooster=function(t){var e=this,o=this.grid.getCellAtMousePosition(t),n=this.grid.getConnectedCellsOfSameType(o);if(n.length>=this.minCellCountToDestroy)if(this.turnsController.Increment(),n.length<this.minCellCountToSpawnBooster){for(var r=0;r<n.length;r++){var c=n[r];this.tryToDestroyBlockInCell(c)}this.lockGrid(0)}else{this.lockGrid(1);var i=this.blockFactory.createBlockOfType(this.getBoosterType(n.length),this.grid.getParent()),l=this.grid.getCellCoords(o),s=this.grid.getCellPosition(l.y,l.x),a=0,u=[],p=function(){e.lockGrid(-1)};for(r=0;r<n.length;r++)u[r]=.45+.1*(Math.random()-.5),a=Math.max(a,u[r]);for(r=0;r<n.length;r++)if(h=(c=n[r]).getBlock()){this.destroyBlockInCell(c);var f=function(){};u[r]==a&&(f=p),h.panToAndDestroyAnimation(s,u[r],f)}this.grid.setBlockInCell(o,i,!0)}else if(o&&o.getBlock()){var h;(h=o.getBlock()).playLandingAnimation()}},e.prototype.getBoosterType=function(t){return t>=this.getMinimumCellCountToSpawnBooster(u.BlockType.MegaBomb)?u.BlockType.MegaBomb:t>=this.getMinimumCellCountToSpawnBooster(u.BlockType.Bomb)?u.BlockType.Bomb:t>=this.getMinimumCellCountToSpawnBooster(u.BlockType.RocketsVertical)?u.BlockType.RocketsVertical:t>=this.getMinimumCellCountToSpawnBooster(u.BlockType.RocketsHorizontal)?u.BlockType.RocketsHorizontal:u.BlockType.Empty},e.prototype.executeBooster=function(t,e){var o=this;this.lockGrid(1),t.executeBooster(e,this.grid,function(t){return o.tryToDestroyBlockInCell(t)},function(){o.lockGrid(-1)})},e.prototype.tryToDestroyBlockInCell=function(t){var e=t.getBlock();e&&(e.playDestroyAnimation(),this.destroyBlockInCell(t),!this.blockFactory.isRegular(e.blockType)&&this.executeBooster(e,t))},e.prototype.destroyBlockInCell=function(t){this.pointsController.Increase(t.getBlock().blockType),t.setBlock(null)},e.prototype.checkIfCellHasBooster=function(t){var e=t.getBlock(),o=e&&!this.blockFactory.isRegular(e.blockType);return o&&(this.tryToDestroyBlockInCell(t),this.turnsController.Increment()),o},c([s(a.default)],e.prototype,"grid",void 0),c([s(p.default)],e.prototype,"blockFactory",void 0),c([s(h.default)],e.prototype,"turnsController",void 0),c([s(d.default)],e.prototype,"pointsController",void 0),c([s],e.prototype,"minCellCountToDestroy",void 0),c([s([f.BlockNumberPair])],e.prototype,"minCellCountsToSpawnBooster",void 0),c([l],e)}(cc.Component);o.default=y,cc._RF.pop()},{"./Block":"Block","./BlockFactory":"BlockFactory","./Grid":"Grid","./PairStructs":"PairStructs","./PointsController":"PointsController","./TurnsController":"TurnsController"}],Block:[function(t,e,o){"use strict";cc._RF.push(e,"e654e73ae5GHY+eKkq8oIbk","Block");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0}),o.BlockType=void 0;var i,l=t("./ObjectPool"),s=cc._decorator,a=s.ccclass,u=s.property;(function(t){t[t.Green=0]="Green",t[t.Purple=1]="Purple",t[t.Red=2]="Red",t[t.Yellow=3]="Yellow",t[t.RocketsHorizontal=4]="RocketsHorizontal",t[t.RocketsVertical=5]="RocketsVertical",t[t.Bomb=6]="Bomb",t[t.MegaBomb=7]="MegaBomb",t[t.Empty=8]="Empty"})(i=o.BlockType||(o.BlockType={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blockType=i.Empty,e.visualNode=null,e.activeTween=null,e.targetCell=null,e.originalZIndex=0,e.picked=!1,e}return r(e,t),e.prototype.start=function(){this.originalZIndex=this.node.zIndex},e.prototype.init=function(t,e){this.blockType=t,this.visualNode||(this.visualNode=this.getComponent(cc.Sprite),this.visualNode||(this.visualNode=this.addComponent(cc.Sprite))),this.node.scale=1,this.node.opacity=255,this.visualNode.node.y=0,this.node.zIndex=this.originalZIndex,this.visualNode.spriteFrame=e},e.prototype.playLandingAnimation=function(){if(this.visualNode){var t=this.visualNode.node,e=t.y;cc.Tween.stopAllByTarget(t),cc.tween(t).to(.08,{y:e+15},{easing:"linear"}).to(.12,{y:e},{easing:"easeOutElastic"}).start()}},e.prototype.setZIndexToMaximum=function(t){this.node.zIndex=t?9999:this.originalZIndex},e.prototype.playDestroyAnimation=function(t){var e=this;if(this.visualNode){var o=this.visualNode.node;o.scale=1,o.opacity=255,this.node.zIndex=9999,cc.Tween.stopAllByTarget(o),cc.tween(o).parallel(cc.tween().to(.12,{scale:1.15},{easing:"sineOut"}),cc.tween().to(.12,{opacity:255},{easing:"sineOut"})).parallel(cc.tween().to(.25,{scale:0},{easing:"backIn"}),cc.tween().to(.4,{opacity:0},{easing:"sineIn"})).call(function(){l.default.Instance.returnObject(e.node),t&&t()}).start()}},e.prototype.panToAndDestroyAnimation=function(t,e,o){var n=this;if(this.visualNode){var r=this.visualNode.node;r.scale=1,r.opacity=255,this.node.zIndex=9999,cc.Tween.stopAllByTarget(r),cc.tween(r).to(e,{position:t,opacity:0},{easing:"sineInOut"}).call(function(){l.default.Instance.returnObject(n.node),o&&o()}).start()}},e.prototype.setPickedStatus=function(t){this.picked=t,cc.Tween.stopAllByTarget(this.node),this.setZIndexToMaximum(t);var e=t?1.2:1;cc.tween(this.node).to(.15,{scale:e},{easing:"sineOut"}).start()},c([u({type:cc.Enum(i)})],e.prototype,"blockType",void 0),c([u(cc.Sprite)],e.prototype,"visualNode",void 0),c([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./ObjectPool":"ObjectPool"}],BombBlock:[function(t,e,o){"use strict";cc._RF.push(e,"7555eavxlBAvLeF2hW8jWef","BombBlock");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../BoosterBlock"),l=t("../../Boosters/Bomb"),s=cc._decorator,a=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.radius=2,e}return r(e,t),e.prototype.onLoad=function(){var t=new l.default;t.setRadius(this.radius),this.setBooster(t)},e.prototype.Execute=function(t,e,o,n){this.executeBooster(t,e,o,function(){null==n||n()})},c([u],e.prototype,"radius",void 0),c([a],e)}(i.default);o.default=p,cc._RF.pop()},{"../../BoosterBlock":"BoosterBlock","../../Boosters/Bomb":"Bomb"}],Bomb:[function(t,e,o){"use strict";cc._RF.push(e,"bfc7bBo2ztGA6Vxtb883bnf","Bomb");var n=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator.ccclass,c=function(){function t(){this.explosionRadius=2}return t.prototype.Execute=function(t,e,o,n,r){if(e&&o){var c=o.getCellRowCol(e);if(c){for(var i=c.row,l=c.col,s=[],a=-this.explosionRadius;a<=this.explosionRadius;a++){var u=o.getCellAt(i+a,l);u&&s.push(u);var p=o.getCellAt(i,l+a);p&&s.push(p)}for(var f=Math.max(0,this.explosionRadius-1),h=1;h<=f;h++)[o.getCellAt(i+h,l+h),o.getCellAt(i+h,l-h),o.getCellAt(i-h,l+h),o.getCellAt(i-h,l-h)].forEach(function(t){t&&s.push(t)});Array.from(new Set(s)).filter(function(t){return t!==e}).forEach(function(e){var r=o.getCellRowCol(e);if(r){var c=.05*Math.max(Math.abs(r.row-i),Math.abs(r.col-l));cc.tween(t.node).delay(c).call(function(){n(e)}).start()}});var d=.05*(this.explosionRadius+1)+.4;cc.tween(o.node).delay(d).call(function(){null==r||r()}).start()}else null==r||r()}else null==r||r()},t.prototype.setRadius=function(t){this.explosionRadius=Math.max(1,t)},n([r("Bomb")],t)}();o.default=c,cc._RF.pop()},{}],BoosterBlock:[function(t,e,o){"use strict";cc._RF.push(e,"5aa03TimqJKq4n7/uRCHNpM","BoosterBlock");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Block"),l=cc._decorator.ccclass,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setBooster=function(t){this.booster=t},e.prototype.executeBooster=function(t,e,o,n){this.booster.Execute(this,t,e,o,n)},c([l],e)}(i.default);o.default=s,cc._RF.pop()},{"./Block":"Block"}],Booster:[function(t,e,o){"use strict";cc._RF.push(e,"3b70d5TUwhNH4DdAp+oOp+S","Booster"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],Cell:[function(t,e,o){"use strict";cc._RF.push(e,"ec7338II9dCdqw0dz5tGlf+","Cell"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.block=null}return t.prototype.isOccupied=function(){return null!==this.block},t.prototype.setBlock=function(t){this.block=t},t.prototype.getBlock=function(){return this.block},t}();o.default=n,cc._RF.pop()},{}],GameEndChecker:[function(t,e,o){"use strict";cc._RF.push(e,"e02dfanYXFLmp+jCK7LVc5L","GameEndChecker");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./GameEndScreen"),l=t("./GameState"),s=cc._decorator,a=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.checkers=[],e.endGameScreen=null,e.isGameEnded=!1,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.checkers.forEach(function(e){if(e){var o=e.getComponent(e.name);o&&o.SetCheckFunction&&o.SetCheckFunction(function(){return t.CheckGameState()})}})},e.prototype.CheckGameState=function(){if(!this.isGameEnded)for(var t=0,e=this.checkers;t<e.length;t++){var o=e[t];if(o){var n=o.getComponent(o.name);if(n&&n.GetGameState){var r=n.GetGameState();if(r===l.GameStates.Won||r===l.GameStates.Lost){this.TriggerEndGame(r);break}}}}},e.prototype.TriggerEndGame=function(t){this.isGameEnded=!0,this.endGameScreen&&(this.endGameScreen.active=!0,this.endGameScreen.getComponent(i.default).SetState(t)),cc.log("Game ended with state: "+l.GameStates[t])},c([u([cc.Node])],e.prototype,"checkers",void 0),c([u(cc.Node)],e.prototype,"endGameScreen",void 0),c([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./GameEndScreen":"GameEndScreen","./GameState":"GameState"}],GameEndScreen:[function(t,e,o){"use strict";cc._RF.push(e,"ba28470YldLO78zbtQdYPZk","GameEndScreen");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./GameState"),l=cc._decorator,s=l.ccclass,a=l.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.resultLabel=null,e}return r(e,t),e.prototype.onLoad=function(){this.resultLabel&&(this.resultLabel.string="")},e.prototype.SetState=function(t){switch(t){case i.GameStates.Won:this.resultLabel.string="\ud83c\udf89 You Won!";break;case i.GameStates.Lost:this.resultLabel.string="\ud83d\udc80 You Lost!";break;case i.GameStates.Continue:this.resultLabel.string=""}},c([a(cc.Label)],e.prototype,"resultLabel",void 0),c([s],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./GameState":"GameState"}],GameState:[function(t,e,o){"use strict";cc._RF.push(e,"f1217iDT+9MtLipuos6f4G9","GameState"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameStates=void 0,function(t){t[t.Continue=0]="Continue",t[t.Lost=1]="Lost",t[t.Won=2]="Won"}(o.GameStates||(o.GameStates={})),cc._RF.pop()},{}],Grid:[function(t,e,o){"use strict";cc._RF.push(e,"92f3fOiGZ9NYrgyCXJZecmX","Grid");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=i.property,a=t("./BlockFactory"),u=t("./Cell"),p=t("./BoosterBlock"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=5,e.height=5,e.cellSize=100,e.parentNode1=null,e.backgroundNode=null,e.bgPadding=0,e.blockFactory=null,e.cells=[],e.cellPositions=[],e.cellCoords=new Map,e}return r(e,t),e.prototype.start=function(){this.createGrid()},e.prototype.setBlockInCell=function(t,e,o){t.setBlock(e);var n=this.getCellCoords(t),r=this.getCellPosition(n.y,n.x);e.node.position=o?r:e.node.position},e.prototype.getAllCells=function(){for(var t=[],e=0;e<this.height;e++)for(var o=0;o<this.width;o++)t.push(this.cells[e][o]);return t},e.prototype.getCellSize=function(){return this.cellSize},e.prototype.getGridParameters=function(){return new cc.Vec2(this.width,this.height)},e.prototype.getCellsInRow=function(t){return t<0||t>=this.height?[]:this.cells[t]},e.prototype.getCellsInColumn=function(t){return t<0||t>=this.width?[]:this.cells.map(function(e){return e[t]}).filter(function(t){return t})},e.prototype.getCellAtPosition=function(t){if(!this.cells||0===this.cells.length)return null;var e=this.getGridOffset(),o=e.offsetX,n=e.offsetY,r=Math.floor((t.x+o+this.cellSize/2)/this.cellSize),c=Math.floor((n+this.cellSize/2-t.y)/this.cellSize);return c<0||c>=this.height||r<0||r>=this.width?null:this.cells[c][r]},e.prototype.getCellAtMousePosition=function(t){if(!this.cells||0===this.cells.length)return null;var e=t.getLocation(),o=this.parentNode1.convertToNodeSpaceAR(e),n=new cc.Vec3(o.x,o.y,0);return this.getCellAtPosition(n)},e.prototype.getCellAt=function(t,e){return t<0||t>=this.height||e<0||e>=this.width?null:this.cells[t][e]},e.prototype.getCellPosition=function(t,e){return this.cellPositions[t][e]},e.prototype.getCellRowCol=function(t){for(var e=0;e<this.height;e++)for(var o=0;o<this.width;o++)if(this.cells[e][o]===t)return{row:e,col:o};return null},e.prototype.isCellOccupied=function(t,e){return t<0||t>=this.height||e<0||e>=this.width||this.cells[t][e].isOccupied()},e.prototype.getCellCoords=function(t){return this.cellCoords.get(t)||null},e.prototype.getParent=function(){return this.parentNode1},e.prototype.hasAnyBoostersOnBoard=function(){for(var t=0;t<this.height;t++)for(var e=0;e<this.width;e++){var o=this.cells[t][e].getBlock();if(o&&o instanceof p.default)return!0}return!1},e.prototype.hasAnyGroupWithSize=function(t){if(!this.cells||0===this.cells.length)return!1;for(var e=new Set,o=0;o<this.height;o++)for(var n=0;n<this.width;n++){var r=this.cells[o][n];if(r&&r.isOccupied()&&!e.has(r)){for(var c=this.getConnectedCellsOfSameType(r),i=0,l=c;i<l.length;i++){var s=l[i];e.add(s)}if(c.length>=t)return!0}}return!1},e.prototype.getConnectedCellsOfSameType=function(t){if(!t||!t.getBlock())return[];for(var e=t.getBlock().blockType,o=new Set,n=[t],r=[];n.length>0;){var c=n.pop();if(c&&!o.has(c)){o.add(c);var i=this.getCellCoords(c);if(i){for(var l=i.x,s=i.y,a=0,u=[this.getCellAt(s-1,l),this.getCellAt(s+1,l),this.getCellAt(s,l-1),this.getCellAt(s,l+1)];a<u.length;a++){var p=u[a];p&&!o.has(p)&&p.isOccupied()&&p.getBlock().blockType===e&&n.push(p)}r.push(c)}}}return r},e.prototype.getGridOffset=function(){return{offsetX:(this.width-1)*this.cellSize/2,offsetY:(this.height-1)*this.cellSize/2}},e.prototype.createGrid=function(){if(this.parentNode1&&this.blockFactory){this.cells=[];for(var t=this.getGridOffset(),e=t.offsetX,o=t.offsetY,n=0;n<this.height;n++){for(var r=[],c=[],i=0;i<this.width;i++){var l=i*this.cellSize-e,s=o-n*this.cellSize,a=new cc.Vec3(l,s,0),p=new u.default;this.cellCoords.set(p,new cc.Vec2(i,n)),r.push(p),c.push(a)}this.cells.push(r),this.cellPositions.push(c)}var f=this.width*this.cellSize,h=this.height*this.cellSize;this.backgroundNode.setContentSize(f+this.bgPadding,h+this.bgPadding),this.node.emit("OnGridCreate",this)}},c([s],e.prototype,"width",void 0),c([s],e.prototype,"height",void 0),c([s],e.prototype,"cellSize",void 0),c([s(cc.Node)],e.prototype,"parentNode1",void 0),c([s(cc.Node)],e.prototype,"backgroundNode",void 0),c([s],e.prototype,"bgPadding",void 0),c([s(a.default)],e.prototype,"blockFactory",void 0),c([l],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./BlockFactory":"BlockFactory","./BoosterBlock":"BoosterBlock","./Cell":"Cell"}],MegaBombBlock:[function(t,e,o){"use strict";cc._RF.push(e,"6f7d0uE4XRFI6F/YJvZ6Dsz","MegaBombBlock");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../BoosterBlock"),l=t("../MegaBomb"),s=cc._decorator.ccclass,a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this.setBooster(new l.default)},c([s],e)}(i.default);o.default=a,cc._RF.pop()},{"../../BoosterBlock":"BoosterBlock","../MegaBomb":"MegaBomb"}],MegaBomb:[function(t,e,o){"use strict";cc._RF.push(e,"27f17Z+8JFMKZR0cN9bdMSa","MegaBomb");var n=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator.ccclass,c=function(){function t(){this.delayPerCell=.03}return t.prototype.Execute=function(t,e,o,n,r){var c=this;if(o){for(var i=o.getGridParameters(),l=i.x,s=i.y,a=[],u=0;u<s;u++)for(var p=0;p<l;p++){var f=o.getCellAt(u,p);f&&a.push({cell:f,sum:u+p})}a.sort(function(t,e){return t.sum-e.sum}),a.forEach(function(t,e){var r=t.cell,i=e*c.delayPerCell;cc.tween(o.node).delay(i).call(function(){return n(r)}).start()});var h=a.length*this.delayPerCell+.05;cc.tween(o.node).delay(h).call(function(){null==r||r()}).start()}else null==r||r()},t.prototype.setDelayPerCell=function(t){this.delayPerCell=Math.max(.005,t)},n([r("MegaBombBooster")],t)}();o.default=c,cc._RF.pop()},{}],ObjectPool:[function(t,e,o){"use strict";cc._RF.push(e,"78de6brN2dE2JVqmWbtrWsc","ObjectPool");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=(i.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pools={},e}var o;return r(e,t),o=e,Object.defineProperty(e,"Instance",{get:function(){return this._instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){o._instance?(cc.warn("Multiple ObjectPool instances detected. Destroying duplicate."),this.node.destroy()):o._instance=this},e.prototype.getObject=function(t,e){void 0===e&&(e=!0);var o=t.data.name;this.pools[o]||(this.pools[o]=[]);for(var n=0;n<this.pools[o].length;n++){var r=this.pools[o][n];if(!r.activeInHierarchy)return r.active=e,r}var c=cc.instantiate(t);return c.name=t.data.name,this.pools[o].push(c),c.active=e,c},e.prototype.returnObject=function(t){t.parent=this.node,t.active=!1},e._instance=null,o=c([l],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],PairStructs:[function(t,e,o){"use strict";cc._RF.push(e,"378895xYopH44K06qMBczaY","PairStructs"),Object.defineProperty(o,"__esModule",{value:!0}),o.BlockNumberPair=o.BlockPrefabPair=o.BlockSpritePair=void 0,cc._decorator;var n=t("./Block"),r=cc.Class({name:"BlockSpritePair",properties:{blockType:{default:n.BlockType.Empty,type:cc.Enum(n.BlockType)},sprite:{default:null,type:cc.SpriteFrame}}});o.BlockSpritePair=r;var c=cc.Class({name:"BlockPrefabPair",properties:{blockType:{default:n.BlockType.Empty,type:cc.Enum(n.BlockType)},prefab:{default:null,type:cc.Prefab}}});o.BlockPrefabPair=c;var i=cc.Class({name:"BlockNumberPair",properties:{blockType:{default:n.BlockType.Empty,type:cc.Enum(n.BlockType)},number:{default:0,type:cc.Integer}}});o.BlockNumberPair=i,cc._RF.pop()},{"./Block":"Block"}],PointsController:[function(t,e,o){"use strict";cc._RF.push(e,"19bf7GXiS1IjohCLYlL2xDL","PointsController");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./StatisticsPanel"),l=t("./PairStructs"),s=t("./GameState"),a=cc._decorator,u=a.ccclass,p=a.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blockPointsTable=[],e.statisticsPanel=null,e.targetPoints=1e3,e.currentPoints=0,e.checkFn=null,e}return r(e,t),e.prototype.onLoad=function(){this.statisticsPanel.SetPoints(this.currentPoints,this.targetPoints)},e.prototype.Increase=function(t){var e=this.blockPointsTable.find(function(e){return e.blockType===t});e?this.currentPoints+=e.number:cc.warn("No point value defined for BlockType: "+t),this.statisticsPanel.SetPoints(this.currentPoints,this.targetPoints),this.checkFn&&this.checkFn()},e.prototype.GetCurrentPoints=function(){return this.currentPoints},e.prototype.GetGameState=function(){return this.currentPoints>=this.targetPoints?s.GameStates.Won:s.GameStates.Continue},e.prototype.SetCheckFunction=function(t){this.checkFn=t},c([p([l.BlockNumberPair])],e.prototype,"blockPointsTable",void 0),c([p(i.default)],e.prototype,"statisticsPanel",void 0),c([p],e.prototype,"targetPoints",void 0),c([u],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./GameState":"GameState","./PairStructs":"PairStructs","./StatisticsPanel":"StatisticsPanel"}],RocketBlock:[function(t,e,o){"use strict";cc._RF.push(e,"9ce8bXilEJKu5+FL7IKTE+D","RocketBlock");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../BoosterBlock"),l=t("../../Boosters/Rocket"),s=cc._decorator.ccclass,a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this.setBooster(new l.default)},c([s],e)}(i.default);o.default=a,cc._RF.pop()},{"../../BoosterBlock":"BoosterBlock","../../Boosters/Rocket":"Rocket"}],Rocket:[function(t,e,o){"use strict";cc._RF.push(e,"9a4990x2yVDx5pGimeHQo4D","Rocket"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Block"),r=function(){function t(){}return t.prototype.Execute=function(t,e,o,r,c){if(t&&e&&o){var i=o.getCellRowCol(e);if(i){var l=i.row,s=i.col,a=[];if(t.blockType===n.BlockType.RocketsHorizontal)a=o.getCellsInRow(l);else{if(t.blockType!==n.BlockType.RocketsVertical)return void c();a=o.getCellsInColumn(s)}a.forEach(function(c){var i=o.getCellRowCol(c);if(i){var a=t.blockType===n.BlockType.RocketsHorizontal?Math.abs(i.col-s):Math.abs(i.row-l);if(c!==e){var u=.05*a;cc.tween(t.node).delay(u).call(function(){r(c)}).start()}}});var u=.05*Math.max.apply(Math,a.map(function(e){var r=o.getCellRowCol(e);return r?t.blockType===n.BlockType.RocketsHorizontal?Math.abs(r.col-s):Math.abs(r.row-l):0}))+.4;cc.tween(o.node).delay(u).call(function(){return c()}).start()}else c()}else c()},t}();o.default=r,cc._RF.pop()},{"../Block":"Block"}],ShuffleAblility:[function(t,e,o){"use strict";cc._RF.push(e,"e0989Tyiy1EdIY3WEvlpUXS","ShuffleAblility");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=(i.property,t("../Ability")),a=t("../Switch"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animationPlaying=!1,e}return r(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.onIconClick=function(){this.animationPlaying||this.gridStable&&(this.blockManager.getGridLock()>1||this.shuffleBoard())},e.prototype.onGridStabilityChange=function(e){t.prototype.onGridStabilityChange.call(this,e),e&&this.checkIfNeedToReshuffle()},e.prototype.checkIfNeedToReshuffle=function(){this.grid.hasAnyGroupWithSize(this.blockManager.getMinCellCountToDestroy())||this.grid.hasAnyBoostersOnBoard()||this.shuffleBoard()},e.prototype.shuffleBoard=function(){var t,e=this;if(!(this.numberOfUses<=0)&&(this.onUsed(),this.grid)){var o=this.grid.getAllCells().filter(function(t){return t.getBlock()});if(!(o.length<2)){this.animationPlaying=!0,this.updateLock(!0);for(var n=o.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1));t=[o[r],o[n]],o[n]=t[0],o[r]=t[1]}var c=[];for(n=0;n<o.length-1;n+=2)c.push([o[n],o[n+1]]);for(var i=0,l=c.length,s=function(){++i>=l&&(e.animationPlaying=!1,e.updateLock(!1),e.checkIfNeedToReshuffle())},u=function(t,e){var o=.2*Math.random();p.scheduleOnce(function(){a.default.swapPickedBlocks(t,e,s)},o)},p=this,f=0,h=c;f<h.length;f++){var d=h[f];u(d[0],d[1])}}}},c([l],e)}(s.default);o.default=u,cc._RF.pop()},{"../Ability":"Ability","../Switch":"Switch"}],StatisticsPanel:[function(t,e,o){"use strict";cc._RF.push(e,"4dd52gJWV1BerqaILKcUpcL","StatisticsPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=i.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.turnsLabel=null,e.pointsLabel=null,e}return r(e,t),e.prototype.SetTurns=function(t,e){this.turnsLabel&&(this.turnsLabel.string=t+" / "+e)},e.prototype.SetPoints=function(t,e){this.pointsLabel&&(this.pointsLabel.string=t+" / "+e)},c([s(cc.Label)],e.prototype,"turnsLabel",void 0),c([s(cc.Label)],e.prototype,"pointsLabel",void 0),c([l],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],SwitchAbility:[function(t,e,o){"use strict";cc._RF.push(e,"b5600PZO0JFwbJU6OtRfddu","SwitchAbility");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,l=i.ccclass,s=(i.property,t("../Switch")),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animationPlaying=!1,e.firstPickedCell=null,e.secondPickedCell=null,e}return r(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this);var e=cc.find("Canvas");e.on(cc.Node.EventType.MOUSE_DOWN,this.onMouseDown,this),e.on(cc.Node.EventType.TOUCH_START,this.onMouseDown,this)},e.prototype.onIconClick=function(){var t=this.boosterEnabled;this.updateLock(!t),this.setEnabled(!this.boosterEnabled),this.boosterEnabled===t&&this.updateLock(t)},e.prototype.setEnabled=function(t){this.animationPlaying||this.boosterEnabled!==t&&this.gridStable&&(this.blockManager.getGridLock()>1||t&&this.numberOfUses<=0||(this.boosterEnabled=t,this.boosterEnabled||this.unpickAll(),this.iconNode&&(this.iconNode.opacity=this.boosterEnabled?255:180),this.updateIconVisual()))},e.prototype.updateIconVisual=function(){if(this.iconNode){var t=this.iconNode.getComponent(cc.Sprite);t&&(this.boosterEnabled?(t.node.color=cc.Color.GREEN,t.node.opacity=255):(t.node.color=cc.Color.WHITE,t.node.opacity=180))}},e.prototype.onMouseDown=function(t){var e=this;if(this.boosterEnabled&&this.grid&&!(this.numberOfUses<=0)){var o=this.grid.getCellAtMousePosition(t);if(o){var n=o.getBlock();if(n&&this.firstPickedCell!==o)return this.firstPickedCell?void(this.secondPickedCell||(this.secondPickedCell=o,n.setPickedStatus(!0),this.onUsed(),s.default.swapPickedBlocks(this.firstPickedCell,this.secondPickedCell,function(){e.animationPlaying=!1,e.firstPickedCell=null,e.secondPickedCell=null,e.onIconClick()}))):(this.firstPickedCell=o,void n.setPickedStatus(!0))}}},e.prototype.unpickAll=function(){this.firstPickedCell&&this.firstPickedCell.getBlock()&&this.firstPickedCell.getBlock().setPickedStatus(!1),this.secondPickedCell&&this.secondPickedCell.getBlock()&&this.secondPickedCell.getBlock().setPickedStatus(!1),this.firstPickedCell=null,this.secondPickedCell=null},c([l],e)}(t("../Ability").default);o.default=a,cc._RF.pop()},{"../Ability":"Ability","../Switch":"Switch"}],Switch:[function(t,e,o){"use strict";cc._RF.push(e,"e2ae2jChDlGYpxI902iPkBv","Switch");var n=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,i=(r.property,function(){function t(){}return t.swapPickedBlocks=function(t,e,o){if(t&&e){var n=t.getBlock(),r=e.getBlock();if(n&&r){var c=n.node.position.clone(),i=r.node.position.clone();t.setBlock(r),e.setBlock(n);var l=i.clone().subtract(c),s=l.len(),a=c.clone().add(i).multiplyScalar(.5),u=.5*s,p=new cc.Vec3(-l.y,l.x,0).normalize(),f=Math.max(u,10),h=a.add(p.clone().multiplyScalar(f)),d=a.add(p.clone().multiplyScalar(-f)),y=function(t,e,o,n){var r=1-t,c=r*r*e.x+2*r*t*o.x+t*t*n.x,i=r*r*e.y+2*r*t*o.y+t*t*n.y;return new cc.Vec3(c,i,0)};cc.tween({t:0}).to(.35,{t:1},{easing:"sineInOut",onUpdate:function(t){var e=y(t.t,c,h,i);n.node.setPosition(e)}}).start(),cc.tween({t:0}).to(.35,{t:1},{easing:"sineInOut",onUpdate:function(t){var e=y(t.t,i,d,c);r.node.setPosition(e)}}).call(function(){null==o||o(),n.setPickedStatus(!1),r.setPickedStatus(!1)}).start()}}},n([c],t)}());o.default=i,cc._RF.pop()},{}],TurnsController:[function(t,e,o){"use strict";cc._RF.push(e,"a8143WVyYBOnKWFKeVUk1Bl","TurnsController");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var r,c=arguments.length,i=c<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(c<3?r(i):c>3?r(e,o,i):r(e,o))||i);return c>3&&i&&Object.defineProperty(e,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./GameState"),l=t("./StatisticsPanel"),s=cc._decorator,a=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxTurnsCount=10,e.statisticsPanel=null,e.currentTurn=0,e.checkFn=null,e}return r(e,t),e.prototype.onLoad=function(){this.statisticsPanel.SetTurns(this.currentTurn,this.maxTurnsCount)},e.prototype.Increment=function(){this.currentTurn++,this.statisticsPanel.SetTurns(this.currentTurn,this.maxTurnsCount),this.checkFn&&this.checkFn()},e.prototype.GetCurrentTurn=function(){return this.currentTurn},e.prototype.GetGameState=function(){return this.currentTurn>=this.maxTurnsCount?i.GameStates.Lost:i.GameStates.Continue},e.prototype.SetCheckFunction=function(t){this.checkFn=t},c([u],e.prototype,"maxTurnsCount",void 0),c([u(l.default)],e.prototype,"statisticsPanel",void 0),c([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./GameState":"GameState","./StatisticsPanel":"StatisticsPanel"}]},{},["AbilityIcon","AbilityManager","Block","BlockFactory","BlockMovementController","BlocksManager","Booster","BoosterBlock","ShuffleAblility","SwitchAbility","Ability","Bomb","BombBlock","MegaBombBlock","RocketBlock","MegaBomb","Rocket","Switch","Cell","GameEndChecker","GameEndScreen","GameState","Grid","ObjectPool","PairStructs","PointsController","StatisticsPanel","TurnsController"]);